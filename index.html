<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FocusType: 200 Common Words</title>
    <style>
        :root {
            --bg-color: #f0f4f8;
            --card-bg: #ffffff;
            --text-main: #333;
            --text-sub: #666;
            --highlight: #3b82f6; /* Blue */
            --correct: #10b981;   /* Green */
            --error: #ef4444;     /* Red */
            --current-bg: #eef2ff;
        }

        * { box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        h1 { margin-bottom: 10px; font-weight: 600; }
        p.subtitle { margin-top: 0; color: var(--text-sub); margin-bottom: 30px; }

        /* Main Container */
        .container {
            background: var(--card-bg);
            width: 100%;
            max-width: 800px;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            text-align: center;
            position: relative;
        }

        /* Stats Bar (Live) */
        .live-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            font-size: 0.9rem;
            color: var(--text-sub);
            font-weight: bold;
        }

        /* Word Display Area */
        .word-box {
            height: 140px; /* Shows about 3 lines */
            overflow: hidden;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            display: flex;
            flex-wrap: wrap;
            align-content: flex-start;
            line-height: 2.5rem;
            font-family: 'Courier New', Courier, monospace;
            font-size: 1.5rem;
            position: relative;
            cursor: text;
        }

        .word {
            margin-right: 12px;
            padding: 2px 5px;
            border-radius: 4px;
            color: #888;
            transition: all 0.1s;
        }

        .word.active {
            background-color: var(--current-bg);
            color: var(--text-main);
            border-bottom: 2px solid var(--highlight);
        }

        .word.correct { color: var(--correct); }
        .word.incorrect { color: var(--error); text-decoration: line-through; }

        /* Input Styling */
        input#type-input {
            width: 100%;
            padding: 15px;
            font-size: 1.2rem;
            border: 2px solid #d1d5db;
            border-radius: 8px;
            outline: none;
            transition: border-color 0.2s;
            font-family: 'Courier New', Courier, monospace;
        }

        input#type-input:focus { border-color: var(--highlight); }
        input#type-input.input-error { background-color: #fef2f2; border-color: var(--error); }

        /* Overlay for Results */
        .modal-overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.95);
            border-radius: 12px;
            display: none; /* Hidden by default */
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }

        .modal-overlay.visible { display: flex; }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
            text-align: left;
        }

        .stat-item {
            background: #f8fafc;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid var(--highlight);
        }
        
        .stat-value { font-size: 1.5rem; font-weight: bold; display: block; }
        .stat-label { font-size: 0.85rem; color: var(--text-sub); text-transform: uppercase; letter-spacing: 0.5px; }

        button.btn-restart {
            background-color: var(--highlight);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.2s;
        }

        button.btn-restart:hover { background-color: #2563eb; }

    </style>
</head>
<body>

    <h1>FocusType</h1>
    <p class="subtitle">Type the 40 words below as fast as you can.</p>

    <div class="container">
        
        <div class="live-stats">
            <span id="progress-text">0 / 40</span>
            <span id="timer-text">00:00</span>
        </div>

        <div class="word-box" id="word-box" onclick="document.getElementById('type-input').focus()">
            </div>

        <input type="text" id="type-input" placeholder="Type here..." autocomplete="off" spellcheck="false">

        <div id="results-modal" class="modal-overlay">
            <h2>Session Complete!</h2>
            
            <div class="stats-grid">
                <div class="stat-item" style="border-color: var(--highlight);">
                    <span class="stat-value" id="res-wpm">0</span>
                    <span class="stat-label">WPM</span>
                </div>
                <div class="stat-item" style="border-color: var(--correct);">
                    <span class="stat-value" id="res-accuracy">0%</span>
                    <span class="stat-label">Accuracy</span>
                </div>
                <div class="stat-item" style="border-color: #8b5cf6;">
                    <span class="stat-value" id="res-time">0s</span>
                    <span class="stat-label">Total Time</span>
                </div>
                <div class="stat-item" style="border-color: var(--error);">
                    <span class="stat-value" id="res-mistakes">0</span>
                    <span class="stat-label">Total Typos</span>
                </div>
                <div class="stat-item" style="border-color: #f59e0b;">
                    <span class="stat-value" id="res-corrected">0</span>
                    <span class="stat-label">Corrected Words</span>
                </div>
                <div class="stat-item" style="border-color: #ef4444;">
                    <span class="stat-value" id="res-uncorrected">0</span>
                    <span class="stat-label">Uncorrected Words</span>
                </div>
            </div>

            <button class="btn-restart" onclick="initGame()">Start New Session</button>
        </div>

    </div>

    <script>
        // --- 1. Data: 200 Common English Words (Length 6-10) ---
        const wordPool = [
            "really", "family", "school", "always", "result", "change", "reason", "person", "moment", "father",
            "report", "course", "mother", "period", "center", "figure", "system", "better", "minute", "friend",
            "street", "letter", "within", "market", "record", "effect", "action", "police", "office", "matter",
            "health", "myself", "ground", "expect", "strong", "common", "series", "amount", "growth", "answer",
            "leader", "energy", "public", "remain", "policy", "theory", "detail", "design", "player", "little",
            "people", "should", "before", "number", "follow", "create", "happen", "during", "appear", "travel",
            "future", "simple", "summer", "winter", "season", "spring", "dinner", "doctor", "sister", "animal",
            "listen", "charge", "member", "memory", "method", "camera", "weight", "window", "writer", "yellow",
            "garden", "global", "manage", "notice", "object", "option", "orange", "parent", "party", "reduce",
            "because", "through", "between", "student", "country", "another", "program", "problem", "service", "against",
            "company", "provide", "however", "develop", "without", "general", "present", "council", "example", "already",
            "process", "suggest", "support", "control", "whether", "product", "history", "himself", "believe", "subject",
            "receive", "quality", "special", "picture", "college", "certain", "teacher", "perhaps", "society", "morning",
            "private", "include", "section", "several", "project", "nothing", "measure", "message", "benefit", "account",
            "century", "success", "perform", "kitchen", "address", "culture", "trouble", "capital", "popular", "produce",
            "situation", "level", "image", "itself", "nature", "likely", "office", "federal", "couple", "social",
            "question", "business", "anything", "decision", "building", "southern", "computer", "hospital", "security", "personal",
            "industry", "interest", "activity", "position", "practice", "evidence", "describe", "director", "response", "campaign",
            "material", "daughter", "congress", "analysis", "movement", "physical", "behavior", "increase", "standard", "remember",
            "consider", "actually", "learning", "research", "military", "resource", "language", "specific", "everyone", "training",
            "recently", "official", "property", "approach", "positive", "pressure", "together", "advanced", "complete", "customer",
            "different", "important", "something", "political", "community", "president", "establish", "authority", "education", "available",
            "financial", "condition", "challenge", "structure", "direction", "character", "attention", "situation", "determine", "statement",
            "agreement", "executive", "recognize", "candidate", "interview", "necessary", "tradition", "beautiful", "knowledge", "operation",
            "government", "everything", "understand", "technology", "difference", "themselves", "television", "investment", "management", "collection",
            "commercial", "conference", "democratic", "discussion", "environment", "experience", "generation", "individual", "population", "production",
            "protection", "republican", "scientific", "successful", "throughout", "university", "absolutely", "apparently", "background", "completely"
        ];

        // --- 2. Game State ---
        const SESSION_LENGTH = 40;
        let currentWords = [];
        let currentIndex = 0;
        let startTime = null;
        let timerInterval = null;
        
        // Stats Counters
        let totalKeystrokes = 0; 
        let totalMistakes = 0; // Total times a wrong key was pressed
        let uncorrectedWords = 0; // Words submitted incorrectly
        let correctedWordCount = 0; // Words with typos but submitted correctly
        let currentWordHasTypo = false; // Flag for the current active word

        // Elements
        const wordBox = document.getElementById('word-box');
        const inputField = document.getElementById('type-input');
        const progressText = document.getElementById('progress-text');
        const timerText = document.getElementById('timer-text');
        const modal = document.getElementById('results-modal');

        // --- 3. Functions ---

        function shuffle(array) {
            let currentIndex = array.length, randomIndex;
            const arrCopy = [...array];
            while (currentIndex != 0) {
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;
                [arrCopy[currentIndex], arrCopy[randomIndex]] = [arrCopy[randomIndex], arrCopy[currentIndex]];
            }
            return arrCopy;
        }

        function initGame() {
            // Reset State
            currentWords = shuffle(wordPool).slice(0, SESSION_LENGTH);
            currentIndex = 0;
            startTime = null;
            totalKeystrokes = 0;
            totalMistakes = 0;
            uncorrectedWords = 0;
            correctedWordCount = 0;
            currentWordHasTypo = false;

            // UI Reset
            inputField.value = '';
            inputField.disabled = false;
            inputField.focus();
            modal.classList.remove('visible');
            progressText.innerText = `0 / ${SESSION_LENGTH}`;
            timerText.innerText = "00:00";
            
            if(timerInterval) clearInterval(timerInterval);

            // Render Words
            wordBox.innerHTML = '';
            currentWords.forEach((word, index) => {
                const span = document.createElement('span');
                span.classList.add('word');
                span.innerText = word;
                if (index === 0) span.classList.add('active');
                wordBox.appendChild(span);
            });
            
            // Scroll to top
            wordBox.scrollTop = 0;
        }

        function updateTimer() {
            const now = new Date();
            const diff = Math.floor((now - startTime) / 1000);
            const m = Math.floor(diff / 60).toString().padStart(2, '0');
            const s = (diff % 60).toString().padStart(2, '0');
            timerText.innerText = `${m}:${s}`;
        }

        function finishGame() {
            clearInterval(timerInterval);
            const endTime = new Date();
            const timeInMinutes = (endTime - startTime) / 60000;
            const timeInSeconds = (endTime - startTime) / 1000;

            // WPM Calculation: (Total Chars / 5) / Minutes
            // We count spaces as characters too for standard WPM, so we add session length (spaces)
            const totalChars = currentWords.join('').length + SESSION_LENGTH;
            const wpm = Math.round((totalChars / 5) / timeInMinutes);
            
            // Accuracy: Correct Keystrokes / Total Keystrokes (Simple approximation)
            // Or: (Total Keystrokes - Total Mistakes) / Total Keystrokes
            let accuracy = 0;
            if(totalKeystrokes > 0) {
                accuracy = Math.max(0, Math.round(((totalKeystrokes - totalMistakes) / totalKeystrokes) * 100));
            }

            // Fill Stats
            document.getElementById('res-wpm').innerText = isFinite(wpm) ? wpm : 0;
            document.getElementById('res-accuracy').innerText = accuracy + "%";
            document.getElementById('res-time').innerText = timeInSeconds.toFixed(1) + "s";
            document.getElementById('res-mistakes').innerText = totalMistakes;
            document.getElementById('res-corrected').innerText = correctedWordCount;
            document.getElementById('res-uncorrected').innerText = uncorrectedWords;

            inputField.disabled = true;
            modal.classList.add('visible');
        }

        // --- 4. Event Listeners ---

        inputField.addEventListener('input', (e) => {
            if (!startTime) {
                startTime = new Date();
                timerInterval = setInterval(updateTimer, 1000);
            }

            const typed = e.target.value;
            const targetWord = currentWords[currentIndex];
            
            // Only count alphanumeric inputs as keystrokes to avoid skewing stats with control keys
            // Simplification: We increment per input event (character added or removed)
            // Ideally, we want to detect if a char was ADDED.
            // For simplicity, we assume strict growth for keystroke count? No, backspace counts too.
            totalKeystrokes++; 

            // Check correctness of current prefix
            if (targetWord.startsWith(typed.trim())) {
                inputField.classList.remove('input-error');
            } else {
                inputField.classList.add('input-error');
                totalMistakes++;
                currentWordHasTypo = true;
            }
        });

        inputField.addEventListener('keydown', (e) => {
            // Handle Spacebar
            if (e.code === 'Space') {
                e.preventDefault(); // Prevent actual space character
                
                const typedValue = inputField.value.trim();
                const targetWord = currentWords[currentIndex];
                const wordSpans = document.querySelectorAll('.word');
                const currentSpan = wordSpans[currentIndex];

                if (typedValue.length > 0) {
                    // Logic for Correct/Incorrect submission
                    if (typedValue === targetWord) {
                        currentSpan.classList.add('correct');
                        currentSpan.classList.remove('active');
                        
                        if (currentWordHasTypo) {
                            correctedWordCount++;
                        }
                    } else {
                        currentSpan.classList.add('incorrect');
                        currentSpan.classList.remove('active');
                        uncorrectedWords++;
                    }

                    // Move to next word
                    currentIndex++;
                    progressText.innerText = `${currentIndex} / ${SESSION_LENGTH}`;
                    inputField.value = '';
                    inputField.classList.remove('input-error');
                    currentWordHasTypo = false;

                    // Check if game over
                    if (currentIndex >= SESSION_LENGTH) {
                        finishGame();
                    } else {
                        // Highlight next word
                        const nextSpan = wordSpans[currentIndex];
                        nextSpan.classList.add('active');
                        
                        // Auto-scroll logic
                        // If the next word is on a lower line relative to the container...
                        // Simplest way: scrollIntoView
                        nextSpan.scrollIntoView({ behavior: "smooth", block: "center" });
                    }
                }
            }
        });

        // Initialize on load
        window.onload = initGame;

    </script>
</body>
</html>
